Attribute VB_Name = "SynchronisedListTestModules"
Option Explicit
Private Type codeItem
    extension As String
    module_name As String
    code_content() As String
End Type

Private Const TypeBinary As Long = 1
Private Const vbext_pp_none As Long = 0
Private Const ForReading As Long = 1, ForWriting As Long = 2, ForAppending As Long = 8

Private Function getCodeDefinition(ByVal itemNo As Long) As codeItem
    With getCodeDefinition
        Select Case itemNo
            Case 1
                .extension = ".cls"
                .module_name = "DummySortByNameItem"
                ReDim .code_content(0 To 0)
                .code_content(0) = "VkVSU0lPTiAxLjAgQ0xBU1MNCkJFR0lODQogIE11bHRpVXNlID0gLTEgICdUcnVlDQpFTkQNCkF0dHJpYnV0ZSBWQl9OYW1lID0gIkR1bW15U29ydEJ5TmFtZUl0ZW0iDQpBdHRyaWJ1dGUgVkJfR2xvYmFsTmFtZVNwYWNlID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9DcmVhdGFibGUgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX1ByZWRlY2xhcmVkSWQgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX0V4cG9zZWQgPSBGYWxzZQ0KJ0BGb2xkZXIoIkdyaWRQcm9qZWN0LlRlc3RzLlRlc3RDbGFzc2VzIikNClB1YmxpYyBOYW1lIEFzIFN0cmluZw0KUHVibGljIE51bWJlciBBcyBMb25nDQpQdWJsaWMgVGltZSBBcyBEb3VibGUNClB1YmxpYyBDcmVhdGlvbkRhdGUgQXMgRGF0ZQ0KDQoNClByaXZhdGUgU3ViIENsYXNzX0luaXRpYWxpemUoKQ0KICAgIE5hbWUgPSBSYW5kb21TdHJpbmcNCiAgICBOdW1iZXIgPSBBcHBsaWNhdGlvbi5Xb3Jrc2hlZXRGdW5jdGlvbi5SYW5kQmV0d2VlbigxMCwgMTAwKQ0KICAgIFRpbWUgPSBOb3cgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcmRlcmVkDQogICAgQ3JlYXRpb25EYXRlID0gR2V0Um5kRGF0ZShOb3cgLSA1MDAsIE5vdyArIDUwMCkNCkVuZCBTdWINCg0K"
            Case 2
                .extension = ".cls"
                .module_name = "SynchroEventsTest"
                ReDim .code_content(0 To 0)
                .code_content(0) = "VkVSU0lPTiAxLjAgQ0xBU1MNCkJFR0lODQogIE11bHRpVXNlID0gLTEgICdUcnVlDQpFTkQNCkF0dHJpYnV0ZSBWQl9OYW1lID0gIlN5bmNocm9FdmVudHNUZXN0Ig0KQXR0cmlidXRlIFZCX0dsb2JhbE5hbWVTcGFjZSA9IEZhbHNlDQpBdHRyaWJ1dGUgVkJfQ3JlYXRhYmxlID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9QcmVkZWNsYXJlZElkID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9FeHBvc2VkID0gRmFsc2UNCidARm9sZGVyKCJHcmlkUHJvamVjdC5UZXN0cy5TeW5jaHJvbml6ZWRMaXN0VGVzdHMiKQ0KUHVibGljIFdpdGhFdmVudHMgU3luY2hybyBBcyBTeW5jaHJvbml6ZWRMaXN0DQpBdHRyaWJ1dGUgU3luY2hyby5WQl9WYXJIZWxwSUQgPSAtMQ0KUHJpdmF0ZSBUeXBlIHRTeW5jaHJvVGVzdA0KICAgIE9yZGVyRXZlbnRSYWlzZWQgQXMgTG9uZw0KICAgIExhc3RDaGFuZ2VJbmRleCBBcyBMb25nDQogICAgUHJvcGVydGllc0V2ZW50UmFpc2VkIEFzIExvbmcNCiAgICBDaGFuZ2VJbmRlY2llcyBBcyBDb2xsZWN0aW9uDQpFbmQgVHlwZQ0KDQpQcml2YXRlIHRoaXMgQXMgdFN5bmNocm9UZXN0DQoNCg0KUHVibGljIFN1YiBDbGVhckNvdW50cygpDQogICAgdGhpcy5MYXN0Q2hhbmdlSW5kZXggPSAtMQ0KICAgIHRoaXMuT3JkZXJFdmVudFJhaXNlZCA9IDANCiAgICB0aGlzLlByb3BlcnRp" & _
"ZXNFdmVudFJhaXNlZCA9IDANCiAgICBTZXQgdGhpcy5DaGFuZ2VJbmRlY2llcyA9IE5ldyBDb2xsZWN0aW9uDQpFbmQgU3ViDQoNClByaXZhdGUgU3ViIFN5bmNocm9fT3JkZXJDaGFuZ2VkKEJ5VmFsIGZpcnN0Q2hhbmdlSW5kZXggQXMgTG9uZykNCiAgICB0aGlzLk9yZGVyRXZlbnRSYWlzZWQgPSB0aGlzLk9yZGVyRXZlbnRSYWlzZWQgKyAxDQogICAgdGhpcy5MYXN0Q2hhbmdlSW5kZXggPSBmaXJzdENoYW5nZUluZGV4DQogICAgdGhpcy5DaGFuZ2VJbmRlY2llcy5BZGQgZmlyc3RDaGFuZ2VJbmRleA0KRW5kIFN1Yg0KDQpQcml2YXRlIFN1YiBTeW5jaHJvX1Byb3BlcnRpZXNDaGFuZ2VkKCkNCiAgICB0aGlzLlByb3BlcnRpZXNFdmVudFJhaXNlZCA9IHRoaXMuUHJvcGVydGllc0V2ZW50UmFpc2VkICsgMQ0KRW5kIFN1Yg0KDQpQdWJsaWMgUHJvcGVydHkgR2V0IE9yZGVyRXZlbnRSYWlzZWQoKSBBcyBMb25nDQogICAgT3JkZXJFdmVudFJhaXNlZCA9IHRoaXMuT3JkZXJFdmVudFJhaXNlZA0KRW5kIFByb3BlcnR5DQoNClB1YmxpYyBQcm9wZXJ0eSBHZXQgTGFzdENoYW5nZUluZGV4KCkgQXMgTG9uZw0KICAgIExhc3RDaGFuZ2VJbmRleCA9IHRoaXMuTGFzdENoYW5nZUluZGV4DQpFbmQgUHJvcGVydHkNCg0KUHVibGljIFByb3BlcnR5IEdldCBQcm9wZXJ0aWVzRXZlbnRSYWlzZWQo" & _
"KSBBcyBMb25nDQogICAgUHJvcGVydGllc0V2ZW50UmFpc2VkID0gdGhpcy5Qcm9wZXJ0aWVzRXZlbnRSYWlzZWQNCkVuZCBQcm9wZXJ0eQ0KDQpQdWJsaWMgUHJvcGVydHkgR2V0IENoYW5nZUluZGVjaWVzKCkgQXMgQ29sbGVjdGlvbg0KICAgIFNldCBDaGFuZ2VJbmRlY2llcyA9IHRoaXMuQ2hhbmdlSW5kZWNpZXMNCkVuZCBQcm9wZXJ0eQ0KDQpQcml2YXRlIFN1YiBDbGFzc19Jbml0aWFsaXplKCkNCiAgICBDbGVhckNvdW50cw0KRW5kIFN1Yg0KDQo="
            Case 3
                .extension = ".bas"
                .module_name = "ShynchronizedListRDTests"
                ReDim .code_content(0 To 1)
                .code_content(0) = "QXR0cmlidXRlIFZCX05hbWUgPSAiU2h5bmNocm9uaXplZExpc3RSRFRlc3RzIg0KT3B0aW9uIEV4cGxpY2l0DQpPcHRpb24gUHJpdmF0ZSBNb2R1bGUNCg0KJ0BUZXN0TW9kdWxlDQonQEZvbGRlcigiR3JpZFByb2plY3QuVGVzdHMuU3luY2hyb25pemVkTGlzdFRlc3RzIikNCg0KUHJpdmF0ZSBBc3NlcnQgQXMgUnViYmVyZHVjay5QZXJtaXNzaXZlQXNzZXJ0Q2xhc3MNClByaXZhdGUgRmFrZXMgQXMgUnViYmVyZHVjay5GYWtlc1Byb3ZpZGVyDQpQcml2YXRlIFN5bmNocm8gQXMgU3luY2hyb25pemVkTGlzdA0KUHJpdmF0ZSBFdmVudE1vbml0b3IgQXMgU3luY2hyb0V2ZW50c1Rlc3QNCg0KJ0BNb2R1bGVJbml0aWFsaXplDQpQdWJsaWMgU3ViIE1vZHVsZUluaXRpYWxpemUoKQ0KICAgICd0aGlzIG1ldGhvZCBydW5zIG9uY2UgcGVyIG1vZHVsZS4NCiAgICBTZXQgQXNzZXJ0ID0gTmV3IFJ1YmJlcmR1Y2suUGVybWlzc2l2ZUFzc2VydENsYXNzDQogICAgU2V0IEZha2VzID0gTmV3IFJ1YmJlcmR1Y2suRmFrZXNQcm92aWRlcg0KDQpFbmQgU3ViDQoNCidATW9kdWxlQ2xlYW51cA0KUHVibGljIFN1YiBNb2R1bGVDbGVhbnVwKCkNCiAgICAndGhpcyBtZXRob2QgcnVucyBvbmNlIHBlciBtb2R1bGUuDQogICAgU2V0IEFzc2VydCA9IE5vdGhpbmcNCiAgICBTZXQgRmFrZXMgPSBOb3RoaW5n" & _
"DQpFbmQgU3ViDQoNCidAVGVzdEluaXRpYWxpemUNClB1YmxpYyBTdWIgVGVzdEluaXRpYWxpemUoKQ0KICAgICd0aGlzIG1ldGhvZCBydW5zIGJlZm9yZSBldmVyeSB0ZXN0IGluIHRoZSBtb2R1bGUuDQogICAgU2V0IFN5bmNocm8gPSBOZXcgU3luY2hyb25pemVkTGlzdA0KICAgIFNldCBFdmVudE1vbml0b3IgPSBOZXcgU3luY2hyb0V2ZW50c1Rlc3QNCiAgICBTZXQgRXZlbnRNb25pdG9yLlN5bmNocm8gPSBTeW5jaHJvDQpFbmQgU3ViDQoNCidAVGVzdENsZWFudXANClB1YmxpYyBTdWIgVGVzdENsZWFudXAoKQ0KICAgICd0aGlzIG1ldGhvZCBydW5zIGFmdGVyIGV2ZXJ5IHRlc3QgaW4gdGhlIG1vZHVsZS4NCkVuZCBTdWINCg0KJ0BUZXN0TWV0aG9kDQpQdWJsaWMgU3ViIFRlc3RBZGRpbmdUd28oKQ0KICAgIE9uIEVycm9yIEdvVG8gVGVzdEZhaWwNCiAgICANCiAgICAnQXJyYW5nZToNCg0KICAgIERpbSBpdGVtczEoKSBBcyBEdW1teUdyaWRJdGVtLCBpdGVtczIoKSBBcyBEdW1teUdyaWRJdGVtDQogICAgaXRlbXMxKCkgPSBnZXRFbXB0eUR1bW15Q2xhc3NlcygyKQ0KICAgIGl0ZW1zMigpID0gZ2V0RW1wdHlEdW1teUNsYXNzZXMoMykNCiAgICANCiAgICAnQWN0Og0KICAgIFdpdGggU3luY2hybw0KICAgICAgICAuQWRkIGl0ZW1zMSgxKSwgaXRlbXMxKDIpDQogICAgICAgIC5B" & _
"ZGQgaXRlbXMyDQogICAgRW5kIFdpdGgNCiAgICANCiAgICAnQXNzZXJ0Og0KICAgIFdpdGggU3luY2hybw0KICAgICAgICBBc3NlcnQuQXJlRXF1YWwgIjUiLCAuU291cmNlRGF0YS5Db3VudCwgIlNvdXJjZURhdGEgYWRkZWQgaW5jb3JyZWN0bHkiDQogICAgICAgIEFzc2VydC5BcmVFcXVhbCAiNSIsIC5Tb3VyY2VEYXRhLkNvdW50LCAiU291cmNlRGF0YSBhZmZlY3RlZCBieSByZWFkaW5nIg0KICAgICAgICBBc3NlcnQuQXJlRXF1YWwgIjUiLCAuR3JpZERhdGEuQ291bnQsICJEZWZhdWx0IEdyaWQgYmVoYXZpb3VyIG5vdCBhcyBleHBlY3RlZCINCiAgICBFbmQgV2l0aA0KICAgIA0KICAgICdjaGVjayBldmVudHMNCiAgICBXaXRoIEV2ZW50TW9uaXRvcg0KICAgICAgICBBc3NlcnQuQXJlRXF1YWwgIjIiLCAuT3JkZXJFdmVudFJhaXNlZCAgICdyZS1vcmRlciBvbiBhZGRpdGlvbg0KICAgICAgICBBc3NlcnQuQXJlRXF1YWwgIjIiLCAuTGFzdENoYW5nZUluZGV4ICAgICdhc3N1bWVzIDFzdCAyIG9yZGVyZWQsIHNvIG5vdyBoYW5kbGUgZnJvbSAyIG9ud2FyZHMNCiAgICAgICAgQXNzZXJ0LkFyZUVxdWFsICIwIiwgLlByb3BlcnRpZXNFdmVudFJhaXNlZCAnbm8gYW1tZW5kbWVudHMgbWFkZQ0KICAgIEVuZCBXaXRoDQpUZXN0RXhpdDoNCiAgICBFeGl0IFN1Yg0KVGVzdEZhaWw6DQog" & _
"ICAgQXNzZXJ0LkZhaWwgIlRlc3QgcmFpc2VkIGFuIGVycm9yOiAjIiAmIEVyci5OdW1iZXIgJiAiIC0gIiAmIEVyci5EZXNjcmlwdGlvbg0KRW5kIFN1Yg0KDQonQFRlc3RNZXRob2QNClB1YmxpYyBTdWIgdGVzdFJlbW92YWwoKQ0KICAgIE9uIEVycm9yIEdvVG8gVGVzdEZhaWwNCiAgICANCiAgICAnQXJyYW5nZToNCiAgICBEaW0gZHVtbXlJdGVtcygpIEFzIER1bW15R3JpZEl0ZW0NCiAgICBkdW1teUl0ZW1zID0gZ2V0RW1wdHlEdW1teUNsYXNzZXMoNSkNCiAgICBTeW5jaHJvLkFkZCBkdW1teUl0ZW1zDQogICAgDQogICAgJ0FjdDoNCiAgICBTeW5jaHJvLlJlbW92ZSBkdW1teUl0ZW1zKDMpDQogICAgICAgIA0KICAgICdBc3NlcnQ6DQogICAgV2l0aCBTeW5jaHJvDQogICAgICAgIEFzc2VydC5BcmVFcXVhbCAiNCIsIC5Tb3VyY2VEYXRhLkNvdW50DQogICAgICAgIEFzc2VydC5BcmVFcXVhbCAiNCIsIC5HcmlkRGF0YS5Db3VudA0KICAgICAgICBBc3NlcnQuSXNUcnVlIC5Tb3VyY2VEYXRhLkNvbnRhaW5zKGR1bW15SXRlbXMoMSkpDQogICAgICAgIEFzc2VydC5Jc0ZhbHNlIC5Tb3VyY2VEYXRhLkNvbnRhaW5zKGR1bW15SXRlbXMoMykpDQogICAgICAgIEFzc2VydC5Jc1RydWUgLkdyaWREYXRhLkNvbnRhaW5zKGR1bW15SXRlbXMoMSkpDQogICAgICAgIEFzc2VydC5Jc0ZhbHNl" & _
"IC5HcmlkRGF0YS5Db250YWlucyhkdW1teUl0ZW1zKDMpKQ0KICAgIEVuZCBXaXRoDQogICAgDQogICAgJ0V2ZW50cyBjaGVjaw0KICAgIFdpdGggRXZlbnRNb25pdG9yDQogICAgICAgIEFzc2VydC5BcmVFcXVhbCAiMiIsIC5MYXN0Q2hhbmdlSW5kZXgsICJDaGFuZ2UgaW5kZXggbm90IG1vbml0b3JlZCBhcyBleHBlY3RlZCIgJ3NpbmNlIGl0IGlzIHRoZSAzcmQgaXRlbSAobm93IGl0ZW0gNCBvZiBvcmlnaW5hbCBhcnJheSkgdGhhdCBoYXMgY2hhbmdlZA0KICAgICAgICBBc3NlcnQuQXJlRXF1YWwgIjIiLCAuT3JkZXJFdmVudFJhaXNlZCAgICdvbmUgZm9yIGFkZGluZywgb25lIGZvciByZW1vdmluZw0KICAgICAgICBBc3NlcnQuQXJlRXF1YWwgIjAiLCAuUHJvcGVydGllc0V2ZW50UmFpc2VkDQogICAgRW5kIFdpdGgNCg0KVGVzdEV4aXQ6DQogICAgRXhpdCBTdWINClRlc3RGYWlsOg0KICAgIEFzc2VydC5GYWlsICJUZXN0IHJhaXNlZCBhbiBlcnJvcjogIyIgJiBFcnIuTnVtYmVyICYgIiAtICIgJiBFcnIuRGVzY3JpcHRpb24NCkVuZCBTdWINCg0KJ0BUZXN0TWV0aG9kDQpQdWJsaWMgU3ViIFRlc3RBbW1lZG1lbnQoKQ0KICAgIE9uIEVycm9yIEdvVG8gVGVzdEZhaWwNCiAgICAnQXJyYW5nZToNCg0KICAgIERpbSBpdGVtcygpIEFzIER1bW15R3JpZEl0ZW0NCiAgICBpdGVtcygp" & _
"ID0gZ2V0RW1wdHlEdW1teUNsYXNzZXMoNSkNCiAgICBTeW5jaHJvLkFkZCBpdGVtcw0KICAgICdBY3Q6DQogICAgU3luY2hyby5NYXJrQXNBbW1lbmRlZCBpdGVtcygzKSAgICAgICAgICAgICAgJ3JhaXNlcyAyIG9yZGVyIGV2ZW50cyENCiAgICANCiAgICAnQXNzZXJ0Og0KICAgIFdpdGggU3luY2hybw0KICAgICAgICBBc3NlcnQuQXJlU2FtZSBpdGVtcygzKSwgLkdyaWREYXRhKDQpICAgICdsYXN0IGl0ZW0gc2luY2UgYWRkZWQgdG8gZW5kIG9mIGdyaWQNCiAgICAgICAgQXNzZXJ0LkFyZVNhbWUgaXRlbXMoMyksIC5Tb3VyY2VEYXRhKDIpICAnM3JkIGl0ZW0gc2luY2Ugbm8gY2hhbmdlDQogICAgRW5kIFdpdGgNCiAgICANCiAgICBXaXRoIEV2ZW50TW9uaXRvcg0KICAgICAgICAnSXRlbXMgZmlyc3QgYWRkZWQsIHRoZW4gYW1tZW5kZWQgaXRlbSByZW1vdmVkIGFuZCByZS1hZGRlZA0KICAgICAgICBBc3NlcnQuQXJlRXF1YWwgIjMiLCAuT3JkZXJFdmVudFJhaXNlZCwgIk51bWJlciBvZiByZS1vcmRlcmluZyBldmVudHMgaXM6ICIgJiAuT3JkZXJFdmVudFJhaXNlZCAmICIsIG5vdCBhcyBleHBlY3RlZCIgJ3JlLW9yZGVyIG9uIGFkZGl0aW9uIGJ1dCBub3Qgd2hlbiBhbW1lbmRlZA0KICAgICAgICBBc3NlcnQuQXJlRXF1YWwgIjQiLCAuTGFzdENoYW5nZUluZGV4LCAiTGFzdCBj" & _
"aGFuZ2UgaW5kZXggaXM6ICIgJiAuTGFzdENoYW5nZUluZGV4ICYgIiwgbm90IGFzIGV4cGVjdGVkIiAnbm8gaW5mbywgc28gbmVlZCBmdWxsIHJlLW9yZGVyDQogICAgICAgIEFzc2VydC5BcmVFcXVhbCAiMCIsIC5Qcm9wZXJ0aWVzRXZlbnRSYWlzZWQgJ25vIGFtbWVuZG1lbnRzIG1hZGUNCiAgICAgICAgQXNzZXJ0LlNlcXVlbmNlRXF1YWxzIEFycmF5KCIwIiwgIjIiLCAiNCIpLCBBcnJheSguQ2hhbmdlSW5kZWNpZXMoMSksIC5DaGFuZ2VJbmRlY2llcygyKSwgLkNoYW5nZUluZGVjaWVzKDMpKQ0KICAgIEVuZCBXaXRoDQpUZXN0RXhpdDoNCiAgICBFeGl0IFN1Yg0KVGVzdEZhaWw6DQogICAgQXNzZXJ0LkZhaWwgIlRlc3QgcmFpc2VkIGFuIGVycm9yOiAjIiAmIEVyci5OdW1iZXIgJiAiIC0gIiAmIEVyci5EZXNjcmlwdGlvbg0KRW5kIFN1Yg0KDQonQFRlc3RNZXRob2QNClB1YmxpYyBTdWIgVGVzdFNvcnRpbmcoKQ0KICAgIE9uIEVycm9yIEdvVG8gVGVzdEZhaWwNCiAgICANCiAgICAnQXJyYW5nZToNCiAgICBEaW0gU29ydGVyIEFzIE5ldyBDYWxsQnlOYW1lQ29tcGFyZXINCiAgICBTb3J0ZXIuSW5pdCAiTmFtZSIsIFZiR2V0DQogICAgDQogICAgJ2dlbmVyYXRlIGNvcnJlY3QgbGlzdA0KICAgIERpbSBDb3JyZWN0TGlzdCBBcyBOZXcgQXJyYXlMaXN0DQogICAgDQogICAgRGlt" & _
"IGkgQXMgTG9uZw0KICAgIEZvciBpID0gMSBUbyA1DQogICAgICAgIERpbSBpdGVtVG9BZGQ6IFNldCBpdGVtVG9BZGQgPSBOZXcgRHVtbXlTb3J0QnlOYW1lSXRlbQ0KICAgICAgICBDb3JyZWN0TGlzdC5BZGQgaXRlbVRvQWRkDQogICAgICAgIFN5bmNocm8uQWRkIGl0ZW1Ub0FkZA0KICAgIE5leHQgaQ0KICAgIENvcnJlY3RMaXN0LlNvcnRfMiBTb3J0ZXINCg0KICAgIA0KICAgICdBY3Q6DQogICAgU3luY2hyby5Tb3J0IFNvcnRlciAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RvdWJsZXMgZ3JpZCBkYXRhIGZvciBzb21lIHJlYXNvbg0KICAgIA0KICAgICdBc3NlcnQ6DQoNCiAgICBBc3NlcnQuU2VxdWVuY2VFcXVhbHMgSXRlcmFibGVUb0FycmF5KENvcnJlY3RMaXN0KSwgSXRlcmFibGVUb0FycmF5KFN5bmNocm8uR3JpZERhdGEuRGF0YSkNCiAgICANClRlc3RFeGl0Og0KICAgIEV4aXQgU3ViDQpUZXN0RmFpbDoNCiAgICBBc3NlcnQuRmFpbCAiVGVzdCByYWlzZWQgYW4gZXJyb3I6ICMiICYgRXJyLk51bWJlciAmICIgLSAiICYgRXJyLkRlc2NyaXB0aW9uDQpFbmQgU3ViDQoNCidAVGVzdE1ldGhvZA0KUHVibGljIFN1YiBUZXN0RmlsdGVyKCkNCiAgICBPbiBFcnJvciBHb1RvIFRlc3RGYWlsDQogICAgDQogICAgJ0FycmFuZ2U6DQogICAgRGltIEZpbHRlcmVyIEFzIE5ldyBD" & _
"YWxsQnlOYW1lQ29tcGFyZXINCiAgICBGaWx0ZXJlci5Jbml0ICJOYW1lIiwgVmJHZXQNCiAgICANCiAgICBEaW0gdGVzdENsYXNzZXMoKSBBcyBEdW1teUdyaWRJdGVtICAgICAgICAgICAnc2hvdWxkIGJlIG5hbWVkIGR1bW15SXRlbTEsMiwzIGV0Yy4NCiAgICBEaW0gZmlsdGVyQWdhaW5zdCBBcyBEdW1teUdyaWRJdGVtDQogICAgdGVzdENsYXNzZXMgPSBnZXRFbXB0eUR1bW15Q2xhc3NlcygpDQogICAgU2V0IGZpbHRlckFnYWluc3QgPSBnZXRFbXB0eUR1bW15Q2xhc3NlcygxKSgxKSAnc2hvdWxkIGFsc28gYmUgbmFtZWQgZHVtbXlJdGVtMQ0KICAgIA0KICAgIFN5bmNocm8uQWRkIHRlc3RDbGFzc2VzDQogICAgDQogICAgJ0FjdDoNCiAgICBTeW5jaHJvLkZpbHRlciBmaWx0ZXJBZ2FpbnN0LCBGaWx0ZXJlciAgICAgICAnYXV0byBmaWx0ZXIgbW9kZSBpcyByZW1vdmUgbWF0Y2hpbmcNCg0KICAgICdBc3NlcnQ6DQogICAgJ2NoZWNrIGlmIGl0ZW1zIHdpdGggbWF0Y2hpbmcgbmFtZSBhcmUgcmVtb3ZlZCBmcm9tICBncmlkDQogICAgQXNzZXJ0LklzVHJ1ZSBTeW5jaHJvLlNvdXJjZURhdGEuQ29udGFpbnModGVzdENsYXNzZXMoMSkpDQogICAgQXNzZXJ0LklzRmFsc2UgU3luY2hyby5HcmlkRGF0YS5Db250YWlucyh0ZXN0Q2xhc3NlcygxKSkNCiAgICANCiAgICAnQWN0Og0KICAg" & _
"IFNldCBmaWx0ZXJBZ2FpbnN0ID0gZ2V0RW1wdHlEdW1teUNsYXNzZXMoMikoMikNCiAgICBTeW5jaHJvLkZpbHRlciBmaWx0ZXJBZ2FpbnN0LCBGaWx0ZXJlciwgbHN0S2VlcE1hdGNoaW5nDQoNCiAgICAnQXNzZXJ0Og0KICAgIEFzc2VydC5Jc1RydWUgU3luY2hyby5HcmlkRGF0YS5Db250YWlucyh0ZXN0Q2xhc3NlcygyKSkNCiAgICBBc3NlcnQuSXNGYWxzZSBTeW5jaHJvLkdyaWREYXRhLkNvbnRhaW5zKHRlc3RDbGFzc2VzKDEpKQ0KICAgIA0KICAgICdFdmVudCBhc3NlcnRpb25zDQogICAgJ2V4cGVjdGVkIGFuIG9yZGVyIGNoYW5nZSBvbiBhZGRpdGlvbg0KICAgICdvcmRlciBjaGFuZ2Ugd2hlbiBmaWx0ZXINCiAgICAnYW5vdGhlciBvcmRlciBjaGFuZ2Ugb24gZmlsdGVyDQogICAgV2l0aCBFdmVudE1vbml0b3INCiAgICAgICAgQXNzZXJ0LkFyZUVxdWFsICIzIiwgLk9yZGVyRXZlbnRSYWlzZWQNCiAgICAgICAgQXNzZXJ0LlNlcXVlbmNlRXF1YWxzIEFycmF5KCIwIiwgIjAiLCAiMSIpLCBJdGVyYWJsZVRvQXJyYXkoLkNoYW5nZUluZGVjaWVzKQ0KICAgIEVuZCBXaXRoDQogICAgDQpUZXN0RXhpdDoNCiAgICBFeGl0IFN1Yg0KVGVzdEZhaWw6DQogICAgQXNzZXJ0LkZhaWwgIlRlc3QgcmFpc2VkIGFuIGVycm9yOiAjIiAmIEVyci5OdW1iZXIgJiAiIC0gIiAmIEVyci5EZXNj"
                .code_content(1) = "cmlwdGlvbg0KRW5kIFN1Yg0KDQo="
            Case 4
                .extension = ".cls"
                .module_name = "BufferEventTests"
                ReDim .code_content(0 To 0)
                .code_content(0) = "VkVSU0lPTiAxLjAgQ0xBU1MNCkJFR0lODQogIE11bHRpVXNlID0gLTEgICdUcnVlDQpFTkQNCkF0dHJpYnV0ZSBWQl9OYW1lID0gIkJ1ZmZlckV2ZW50VGVzdHMiDQpBdHRyaWJ1dGUgVkJfR2xvYmFsTmFtZVNwYWNlID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9DcmVhdGFibGUgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX1ByZWRlY2xhcmVkSWQgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX0V4cG9zZWQgPSBGYWxzZQ0KJ0BGb2xkZXIoIkdyaWRQcm9qZWN0LlRlc3RzLlRlc3RDbGFzc2VzIikNClB1YmxpYyBXaXRoRXZlbnRzIEJ1ZmZlciBBcyBjbHNCdWZmZXINCkF0dHJpYnV0ZSBCdWZmZXIuVkJfVmFySGVscElEID0gLTENClByaXZhdGUgVHlwZSB0QnVmZmVyVGVzdA0KICAgIEFkZGVkRXZlbnRSYWlzZWQgQXMgTG9uZw0KICAgIEFtbWVuZGVkRXZlbnRSYWlzZWQgQXMgTG9uZw0KICAgIFJlbW92ZWRFdmVudFJhaXNlZCBBcyBMb25nDQpFbmQgVHlwZQ0KDQpQcml2YXRlIHRoaXMgQXMgdEJ1ZmZlclRlc3QNCg0KUHJpdmF0ZSBTdWIgQnVmZmVyX0l0ZW1zQWRkZWQoKQ0KICAgIHRoaXMuQWRkZWRFdmVudFJhaXNlZCA9IHRoaXMuQWRkZWRFdmVudFJhaXNlZCArIDENCkVuZCBTdWINCg0KUHJpdmF0ZSBTdWIgQnVmZmVyX0l0ZW1zQW1tZW5kZWQoKQ0KICAgIHRoaXMuQW1tZW5kZWRFdmVudFJhaXNl" & _
"ZCA9IHRoaXMuQW1tZW5kZWRFdmVudFJhaXNlZCArIDENCkVuZCBTdWINCg0KUHJpdmF0ZSBTdWIgQnVmZmVyX0l0ZW1zUmVtb3ZlZCgpDQogICAgdGhpcy5SZW1vdmVkRXZlbnRSYWlzZWQgPSB0aGlzLlJlbW92ZWRFdmVudFJhaXNlZCArIDENCkVuZCBTdWINCg0KUHVibGljIFN1YiBDbGVhckNvdW50cygpDQogICAgdGhpcy5BZGRlZEV2ZW50UmFpc2VkID0gMA0KICAgIHRoaXMuQW1tZW5kZWRFdmVudFJhaXNlZCA9IDANCiAgICB0aGlzLlJlbW92ZWRFdmVudFJhaXNlZCA9IDANCkVuZCBTdWINCg0KUHVibGljIFByb3BlcnR5IEdldCBBZGRlZEV2ZW50UmFpc2VkKCkgQXMgTG9uZw0KICAgIEFkZGVkRXZlbnRSYWlzZWQgPSB0aGlzLkFkZGVkRXZlbnRSYWlzZWQNCkVuZCBQcm9wZXJ0eQ0KDQpQdWJsaWMgUHJvcGVydHkgR2V0IEFtbWVuZGVkRXZlbnRSYWlzZWQoKSBBcyBMb25nDQogICAgQW1tZW5kZWRFdmVudFJhaXNlZCA9IHRoaXMuQW1tZW5kZWRFdmVudFJhaXNlZA0KRW5kIFByb3BlcnR5DQoNClB1YmxpYyBQcm9wZXJ0eSBHZXQgUmVtb3ZlZEV2ZW50UmFpc2VkKCkgQXMgTG9uZw0KICAgIFJlbW92ZWRFdmVudFJhaXNlZCA9IHRoaXMuUmVtb3ZlZEV2ZW50UmFpc2VkDQpFbmQgUHJvcGVydHkNCg0KUHJpdmF0ZSBTdWIgQ2xhc3NfSW5pdGlhbGl6ZSgpDQogICAgQ2xlYXJDb3Vu" & _
"dHMNCkVuZCBTdWINCg0K"
            Case 5
                .extension = ".bas"
                .module_name = "testUtils"
                ReDim .code_content(0 To 0)
                .code_content(0) = "QXR0cmlidXRlIFZCX05hbWUgPSAidGVzdFV0aWxzIg0KJ0BGb2xkZXIoIkdyaWRQcm9qZWN0LlRlc3RzLlV0aWxzIikNCk9wdGlvbiBFeHBsaWNpdA0KDQpQdWJsaWMgRnVuY3Rpb24gZ2V0RW1wdHlEdW1teUNsYXNzZXMoT3B0aW9uYWwgbiBBcyBMb25nID0gNSkgQXMgRHVtbXlHcmlkSXRlbSgpDQogICAgRGltIHJlc3VsdHMoKSBBcyBEdW1teUdyaWRJdGVtDQogICAgUmVEaW0gcmVzdWx0cygxIFRvIG4pDQogICAgRGltIGR1bW15SXRlbSBBcyBEdW1teUdyaWRJdGVtDQogICAgRGltIGkgQXMgTG9uZw0KICAgIEZvciBpID0gMSBUbyBuDQogICAgICAgIFNldCBkdW1teUl0ZW0gPSBOZXcgRHVtbXlHcmlkSXRlbQ0KICAgICAgICBkdW1teUl0ZW0uTmFtZSA9ICJEdW1teUl0ZW0gIiAmIGkNCiAgICAgICAgU2V0IHJlc3VsdHMoaSkgPSBkdW1teUl0ZW0NCiAgICBOZXh0IGkNCiAgICBnZXRFbXB0eUR1bW15Q2xhc3NlcyA9IHJlc3VsdHMNCkVuZCBGdW5jdGlvbg0KDQpQdWJsaWMgRnVuY3Rpb24gZ2V0RHVtbXlDbGFzc2VzV2l0aFByb3BlcnRpZXMoT3B0aW9uYWwgbiBBcyBWYXJpYW50LCBPcHRpb25hbCBwcm9wZXJ0eVBhaXJzIEFzIFZhcmlhbnQpIEFzIER1bW15R3JpZEl0ZW0oKQ0KICAgICdwcm9wZXJ0eXBhaXJzIGlzIHplcm8gaW5kZXhlZCBhcnJheSBvZiAwIGluZGV4ZWQgKG5h" & _
"bWUsdmFsKSBhcnJheXMNCiAgIA0KICAgICchISEgTmVlZCBBcnJheShJdGVtRGVmaW5pdGlvbjEocHJvcGVydHkxKG5hbWUsdmFsKSxwcm9wZXJ0eTIobmFtZSx2YWwpLC4uLiksSXRlbTIoLi4uKSwuLi4pDQogICAgJ1Vib3VuZChQcm9wZXJ0eVBhaXJzKSBtdXN0IGVxdWFsIG4NCiAgICBJZiBJc01pc3NpbmcobikgVGhlbg0KICAgICAgICBuID0gNQ0KICAgICAgICBJZiBOb3QgSXNNaXNzaW5nKHByb3BlcnR5UGFpcnMpIFRoZW4NCiAgICAgICAgICAgIG4gPSBVQm91bmQocHJvcGVydHlQYWlycykgKyAxDQogICAgICAgIEVuZCBJZg0KICAgIEVsc2UNCiAgICAgICAgSWYgTm90IElzTWlzc2luZyhwcm9wZXJ0eVBhaXJzKSBUaGVuDQogICAgICAgICAgICBJZiBVQm91bmQocHJvcGVydHlQYWlycykgPD4gbiAtIDEgVGhlbg0KICAgICAgICAgICAgICAgIEVyci5EZXNjcmlwdGlvbiA9ICJwcm9wZXJ0eSBwYWlycyBhcmVuJ3Qgb2Ygc2FtZSBzaXplIGFzIG4iDQogICAgICAgICAgICAgICAgRXJyLnJhaXNlIDUNCiAgICAgICAgICAgIEVuZCBJZg0KICAgICAgICBFbmQgSWYNCiAgICBFbmQgSWYNCg0KICAgIERpbSByZXN1bHRzKCkgQXMgRHVtbXlHcmlkSXRlbQ0KICAgIFJlRGltIHJlc3VsdHMoMSBUbyBuKQ0KICAgIERpbSBkdW1teUl0ZW0gQXMgRHVtbXlHcmlkSXRlbQ0KICAgIERp" & _
"bSBpIEFzIExvbmcNCiAgICBGb3IgaSA9IDEgVG8gbg0KICAgICAgICBTZXQgZHVtbXlJdGVtID0gTmV3IER1bW15R3JpZEl0ZW0NCiAgICAgICAgZHVtbXlJdGVtLk5hbWUgPSAiRHVtbXlJdGVtICIgJiBpDQogICAgICAgIERpbSBzb3J0aW5nSW50ZXJmYWNlIEFzIElTb3J0YWJsZQ0KICAgICAgICBTZXQgc29ydGluZ0ludGVyZmFjZSA9IGR1bW15SXRlbQ0KICAgICAgICBXaXRoIHNvcnRpbmdJbnRlcmZhY2UNCiAgICAgICAgICAgIElmIElzTWlzc2luZyhwcm9wZXJ0eVBhaXJzKSBUaGVuDQogICAgICAgICAgICAgICAgc29ydGluZ0ludGVyZmFjZS5Qcm9wZXJ0aWVzLkluaXRSYW5kb20NCiAgICAgICAgICAgIEVsc2UNCiAgICAgICAgICAgICAgICBEaW0gcHJvcGVydHlQYWlyDQogICAgICAgICAgICAgICAgU2V0IHByb3BlcnR5UGFpciA9IHByb3BlcnR5UGFpcnMoaSAtIDEpDQogICAgICAgICAgICAgICAgJy5Qcm9wZXJ0aWVzLmFkZFByb3BlcnR5IHByb3BlcnR5UGFpcigwKSwgcHJvcGVydHlQYWlyKDEpDQogICAgICAgICAgICBFbmQgSWYNCiAgICAgICAgRW5kIFdpdGgNCiAgICAgICAgICAgIA0KICAgICAgICBTZXQgcmVzdWx0cyhpKSA9IGR1bW15SXRlbQ0KICAgIE5leHQgaQ0KICAgIGdldER1bW15Q2xhc3Nlc1dpdGhQcm9wZXJ0aWVzID0gcmVzdWx0cw0KRW5kIEZ1bmN0" & _
"aW9uDQoNClB1YmxpYyBGdW5jdGlvbiBJdGVyYWJsZVRvQXJyYXkoQnlWYWwgaXRlcmFibGVPYmplY3QgQXMgVmFyaWFudCkgQXMgVmFyaWFudA0KICAgIElmIE5vdCBpc0l0ZXJhYmxlKGl0ZXJhYmxlT2JqZWN0KSBUaGVuIEVyci5EZXNjcmlwdGlvbiA9ICJZb3UgY2FuIG9ubHkgY29udmVydCBpdGVyYWJsZSBvYmplY3RzIHRvIGFycmF5cyI6IEVyci5yYWlzZSA1DQogICAgRGltIGl0ZW0NCiAgICBEaW0gcmVzdWx0KCkNCiAgICBEaW0gQ291bnQgQXMgTG9uZw0KICAgIENvdW50ID0gMA0KICAgIEZvciBFYWNoIGl0ZW0gSW4gaXRlcmFibGVPYmplY3QNCiAgICAgICAgSWYgaXNJdGVyYWJsZShpdGVtKSBUaGVuIExldFNldCBpdGVtLCBJdGVyYWJsZVRvQXJyYXkoaXRlbSkNCiAgICAgICAgUmVEaW0gUHJlc2VydmUgcmVzdWx0KDAgVG8gQ291bnQpDQogICAgICAgIExldFNldCByZXN1bHQoQ291bnQpLCBpdGVtDQogICAgICAgIENvdW50ID0gQ291bnQgKyAxDQogICAgTmV4dA0KICAgIEl0ZXJhYmxlVG9BcnJheSA9IHJlc3VsdA0KRW5kIEZ1bmN0aW9uDQoNCg=="
            Case 6
                .extension = ".cls"
                .module_name = "DummyGridItem"
                ReDim .code_content(0 To 0)
                .code_content(0) = "VkVSU0lPTiAxLjAgQ0xBU1MNCkJFR0lODQogIE11bHRpVXNlID0gLTEgICdUcnVlDQpFTkQNCkF0dHJpYnV0ZSBWQl9OYW1lID0gIkR1bW15R3JpZEl0ZW0iDQpBdHRyaWJ1dGUgVkJfR2xvYmFsTmFtZVNwYWNlID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9DcmVhdGFibGUgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX1ByZWRlY2xhcmVkSWQgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX0V4cG9zZWQgPSBGYWxzZQ0KJ0BGb2xkZXIoIkdyaWRQcm9qZWN0LlRlc3RzLlRlc3RDbGFzc2VzIikNCkltcGxlbWVudHMgSUdyaWRhYmxlDQpJbXBsZW1lbnRzIElTb3J0YWJsZQ0KUHVibGljIE5hbWUgQXMgU3RyaW5nDQpQcml2YXRlIFR5cGUgVER1bW15SXRlbQ0KICAgIFByb3BlcnRpZXNPYmogQXMgUHJvcGVydGllcw0KRW5kIFR5cGUNCg0KUHJpdmF0ZSB0aGlzIEFzIFREdW1teUl0ZW0NCg0KDQpQcml2YXRlIFN1YiBJR3JpZGFibGVfUmVBbGlnbigpDQogICAgRXJyLnJhaXNlIDUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1RPRE8gaW1wbGVtZW50IGludGVyZmFjZSBtZW1iZXINCkVuZCBTdWINCg0KUHJpdmF0ZSBQcm9wZXJ0eSBTZXQgSUdyaWRhYmxlX3BhcmVudFVGKEJ5VmFsIFZhbHVlIEFzIE1TRm9ybXMuVXNlckZvcm0pDQogICAgRXJyLnJhaXNlIDUgICAgICAgICAgICAgICAgICAg" & _
"ICAgICAgICAgICAgICAgJ1RPRE8gaW1wbGVtZW50IGludGVyZmFjZSBtZW1iZXINCkVuZCBQcm9wZXJ0eQ0KDQpQcml2YXRlIFByb3BlcnR5IExldCBJR3JpZGFibGVfVmlzaWJsZShCeVZhbCBWYWx1ZSBBcyBCb29sZWFuKQ0KRGVidWcuUHJpbnQgIldhcm5pbmcsIElHcmlkYWJsZSBwcm9wZXJ0eSB1c2VkIg0KICAgICdFcnIucmFpc2UgNSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1lbnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgR2V0IElHcmlkYWJsZV9WaXNpYmxlKCkgQXMgQm9vbGVhbg0KICAgIEVyci5yYWlzZSA1ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUT0RPIGltcGxlbWVudCBpbnRlcmZhY2UgbWVtYmVyDQpFbmQgUHJvcGVydHkNCg0KUHJpdmF0ZSBQcm9wZXJ0eSBTZXQgSUdyaWRhYmxlX0V2ZW50c09iamVjdChCeVJlZiBWYWx1ZSBBcyBjbHNHcmlkRXZlbnRzKQ0KICAgIEVyci5yYWlzZSA1ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUT0RPIGltcGxlbWVudCBpbnRlcmZhY2UgbWVtYmVyDQpFbmQgUHJvcGVydHkNCg0KUHJpdmF0ZSBQcm9wZXJ0eSBHZXQgSUdyaWRhYmxlX0l0ZW1XaWR0aCgpIEFzIExvbmcNCiAgICBFcnIucmFpc2UgNSAgICAg" & _
"ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1lbnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgTGV0IElHcmlkYWJsZV9JdGVtV2lkdGgoQnlWYWwgVmFsdWUgQXMgTG9uZykNCiAgICBFcnIucmFpc2UgNSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1lbnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgR2V0IElHcmlkYWJsZV9JdGVtSGVpZ2h0KCkgQXMgTG9uZw0KICAgIEVyci5yYWlzZSA1ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUT0RPIGltcGxlbWVudCBpbnRlcmZhY2UgbWVtYmVyDQpFbmQgUHJvcGVydHkNCg0KUHJpdmF0ZSBQcm9wZXJ0eSBMZXQgSUdyaWRhYmxlX0l0ZW1IZWlnaHQoQnlWYWwgVmFsdWUgQXMgTG9uZykNCiAgICBFcnIucmFpc2UgNSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1lbnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgR2V0IElHcmlkYWJsZV9MZWZ0Q29vcmRpbmF0ZSgpIEFzIExvbmcNCiAgICBFcnIucmFpc2UgNSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1l" & _
"bnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgTGV0IElHcmlkYWJsZV9MZWZ0Q29vcmRpbmF0ZShCeVZhbCBWYWx1ZSBBcyBMb25nKQ0KICAgIEVyci5yYWlzZSA1ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUT0RPIGltcGxlbWVudCBpbnRlcmZhY2UgbWVtYmVyDQpFbmQgUHJvcGVydHkNCg0KUHJpdmF0ZSBQcm9wZXJ0eSBMZXQgSUdyaWRhYmxlX0xlZnRPZmZzZXQoQnlWYWwgVmFsdWUgQXMgTG9uZykNCiAgICBFcnIucmFpc2UgNSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1lbnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgR2V0IElHcmlkYWJsZV9Ub3BDb29yZGluYXRlKCkgQXMgTG9uZw0KICAgIEVyci5yYWlzZSA1ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUT0RPIGltcGxlbWVudCBpbnRlcmZhY2UgbWVtYmVyDQpFbmQgUHJvcGVydHkNCg0KUHJpdmF0ZSBQcm9wZXJ0eSBMZXQgSUdyaWRhYmxlX1RvcENvb3JkaW5hdGUoQnlWYWwgVmFsdWUgQXMgTG9uZykNCiAgICBFcnIucmFpc2UgNSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1lbnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5k" & _
"IFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgTGV0IElHcmlkYWJsZV9Ub3BPZmZzZXQoQnlWYWwgVmFsdWUgQXMgTG9uZykNCiAgICBFcnIucmFpc2UgNSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1lbnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgTGV0IElTb3J0YWJsZV9Tb3J0aW5nUHJvcGVydHkoQnlWYWwgVmFsdWUgQXMgVmFyaWFudCkNCiAgICBFcnIucmFpc2UgNSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVE9ETyBpbXBsZW1lbnQgaW50ZXJmYWNlIG1lbWJlcg0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgR2V0IElTb3J0YWJsZV9Tb3J0aW5nUHJvcGVydHkoKSBBcyBWYXJpYW50DQogICAgRXJyLnJhaXNlIDUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1RPRE8gaW1wbGVtZW50IGludGVyZmFjZSBtZW1iZXINCkVuZCBQcm9wZXJ0eQ0KDQpQcml2YXRlIFByb3BlcnR5IEdldCBJU29ydGFibGVfUHJvcGVydGllcygpIEFzIFByb3BlcnRpZXMNCiAgICBJZiB0aGlzLlByb3BlcnRpZXNPYmogSXMgTm90aGluZyBUaGVuIFNldCB0aGlzLlByb3BlcnRpZXNPYmogPSBOZXcgUHJvcGVydGllcw0KICAgIFNldCBJU29ydGFibGVfUHJvcGVydGll" & _
"cyA9IHRoaXMuUHJvcGVydGllc09iag0KRW5kIFByb3BlcnR5DQoNCg=="
            Case 7
                .extension = ".cls"
                .module_name = "bufferTestRunner"
                ReDim .code_content(0 To 0)
                .code_content(0) = "VkVSU0lPTiAxLjAgQ0xBU1MNCkJFR0lODQogIE11bHRpVXNlID0gLTEgICdUcnVlDQpFTkQNCkF0dHJpYnV0ZSBWQl9OYW1lID0gImJ1ZmZlclRlc3RSdW5uZXIiDQpBdHRyaWJ1dGUgVkJfR2xvYmFsTmFtZVNwYWNlID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9DcmVhdGFibGUgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX1ByZWRlY2xhcmVkSWQgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX0V4cG9zZWQgPSBGYWxzZQ0KJ0BGb2xkZXIoIkdyaWRQcm9qZWN0LlRlc3RzLlRlc3RDbGFzc2VzIikNClByaXZhdGUgV2l0aEV2ZW50cyB0ZXN0QnVmZmVyIEFzIGNsc0J1ZmZlcg0KQXR0cmlidXRlIHRlc3RCdWZmZXIuVkJfVmFySGVscElEID0gLTENClByaXZhdGUgaXRlbXNSZW1haW5pbmcgQXMgTG9uZw0KSW1wbGVtZW50cyBJQ29tcGFyYWJsZQ0KUHVibGljIGNvbXBhcmFibGVWYWwgQXMgRG91YmxlDQoNClB1YmxpYyBTdWIgVGVzdEV2ZW50cygpDQogICAgU2V0IHRlc3RCdWZmZXIgPSBOZXcgY2xzQnVmZmVyDQogICAgV2l0aCB0ZXN0QnVmZmVyDQogICAgICAgIC5BZGRpbmdUcmlnZ2VyID0gMg0KICAgICAgICBpdGVtc1JlbWFpbmluZyA9IDUNCiAgICAgICAgLkFkZEl0ZW1zIFthMTphNV0NCiAgICBFbmQgV2l0aA0KRW5kIFN1Yg0KDQpQcml2YXRlIFN1YiBDbGFzc19Jbml0aWFsaXplKCkNCiAgICBj" & _
"b21wYXJhYmxlVmFsID0gUm5kDQpFbmQgU3ViDQoNClByaXZhdGUgRnVuY3Rpb24gSUNvbXBhcmFibGVfQ29tcGFyZVRvKEJ5VmFsIG9iaiBBcyBWYXJpYW50KSBBcyBMb25nDQogICAgSWYgTWUuY29tcGFyYWJsZVZhbCA8IG9iai5jb21wYXJhYmxlVmFsIFRoZW4NCiAgICAgICAgSUNvbXBhcmFibGVfQ29tcGFyZVRvID0gLTENCiAgICBFbHNlSWYgTWUuY29tcGFyYWJsZVZhbCA+IG9iai5jb21wYXJhYmxlVmFsIFRoZW4NCiAgICAgICAgSUNvbXBhcmFibGVfQ29tcGFyZVRvID0gMQ0KICAgIEVsc2UNCiAgICAgICAgSUNvbXBhcmFibGVfQ29tcGFyZVRvID0gMA0KICAgIEVuZCBJZg0KRW5kIEZ1bmN0aW9uDQoNClByaXZhdGUgU3ViIHRlc3RCdWZmZXJfSXRlbXNBZGRlZCgpDQpEZWJ1Zy5Bc3NlcnQgVUJvdW5kKHRlc3RCdWZmZXIuQWRkZWRJdGVtcykgPSBBcHBsaWNhdGlvbi5Xb3Jrc2hlZXRGdW5jdGlvbi5taW4odGVzdEJ1ZmZlci5BZGRpbmdUcmlnZ2VyLCBpdGVtc1JlbWFpbmluZykNCiAgICBpdGVtc1JlbWFpbmluZyA9IGl0ZW1zUmVtYWluaW5nIC0gMg0KRW5kIFN1Yg0KDQo="
            Case 8
                .extension = ".cls"
                .module_name = "filterListComparerTest"
                ReDim .code_content(0 To 0)
                .code_content(0) = "VkVSU0lPTiAxLjAgQ0xBU1MNCkJFR0lODQogIE11bHRpVXNlID0gLTEgICdUcnVlDQpFTkQNCkF0dHJpYnV0ZSBWQl9OYW1lID0gImZpbHRlckxpc3RDb21wYXJlclRlc3QiDQpBdHRyaWJ1dGUgVkJfR2xvYmFsTmFtZVNwYWNlID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9DcmVhdGFibGUgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX1ByZWRlY2xhcmVkSWQgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX0V4cG9zZWQgPSBGYWxzZQ0KJ0BGb2xkZXIoR3JpZFByb2plY3QuVGVzdHMuVGVzdENsYXNzZXMpDQoNCg0KSW1wbGVtZW50cyBJU29ydGFibGUNClByaXZhdGUgcHJvcGVydHlTZXQgQXMgTmV3IFByb3BlcnRpZXMNCg0KDQoNCidQcml2YXRlIEZ1bmN0aW9uIElDb21wYXJhYmxlX0NvbXBhcmVUbyhCeVZhbCBvYmogQXMgVmFyaWFudCkgQXMgTG9uZw0KJyAgICBJZiBvYmoudmFsdWUgPCBNZS52YWx1ZSBUaGVuDQonICAgICAgICBJQ29tcGFyYWJsZV9Db21wYXJlVG8gPSAxDQonICAgIEVsc2VJZiBvYmoudmFsdWUgPiBNZS52YWx1ZSBUaGVuDQonICAgICAgICBJQ29tcGFyYWJsZV9Db21wYXJlVG8gPSAtMQ0KJyAgICBFbHNlDQonICAgICAgICBJQ29tcGFyYWJsZV9Db21wYXJlVG8gPSAwDQonICAgIEVuZCBJZg0KJ0VuZCBGdW5jdGlvbg0KDQpQdWJsaWMgU3ViIHByaW50U2VsZigpDQpEZWJ1Zy5Q" & _
"cmludCBWYWx1ZQ0KRW5kIFN1Yg0KDQpQdWJsaWMgUHJvcGVydHkgTGV0IFZhbHVlKEJ5VmFsIE51bWJlciBBcyBMb25nKQ0KICAgIHByb3BlcnR5U2V0LmFkZFByb3BlcnR5ICJ2YWx1ZSIsIE51bWJlcg0KRW5kIFByb3BlcnR5DQoNClB1YmxpYyBQcm9wZXJ0eSBHZXQgVmFsdWUoKSBBcyBMb25nDQogICAgVmFsdWUgPSBwcm9wZXJ0eVNldC5pdGVtRnJvbU5hbWUoInZhbHVlIikNCkVuZCBQcm9wZXJ0eQ0KDQpQcml2YXRlIFByb3BlcnR5IEdldCBJU29ydGFibGVfUHJvcGVydGllcygpIEFzIFByb3BlcnRpZXMNCiAgICBTZXQgSVNvcnRhYmxlX1Byb3BlcnRpZXMgPSBwcm9wZXJ0eVNldA0KRW5kIFByb3BlcnR5DQoNClByaXZhdGUgUHJvcGVydHkgR2V0IElTb3J0YWJsZV9Tb3J0aW5nUHJvcGVydHkoKSBBcyBWYXJpYW50DQogICAgSVNvcnRhYmxlX1NvcnRpbmdQcm9wZXJ0eSA9IFZhbHVlDQpFbmQgUHJvcGVydHkNCg0KUHJpdmF0ZSBQcm9wZXJ0eSBMZXQgSVNvcnRhYmxlX1NvcnRpbmdQcm9wZXJ0eShCeVZhbCBTb3J0TW9kZSBBcyBWYXJpYW50KQ0KICAgICdkbyBub3RoaW5nLCBhbHdheXMgc29ydCBieSB2YWx1ZQ0KICAgIElmIE5vdCBVQ2FzZShTb3J0TW9kZSkgPSAiVkFMVUUiIFRoZW4NCiAgICAgICAgRXJyLkRlc2NyaXB0aW9uID0gImZpbHRlciBsaXN0IHRlc3QgY2xhc3Mg" & _
"Y2FuIG9ubHkgYmUgc29ydGVkIGJ5IHZhbHVlIg0KICAgICAgICBFcnIucmFpc2UgNA0KICAgIEVuZCBJZg0KRW5kIFByb3BlcnR5DQoNCg=="
        Case Else
            .extension = "missing"
        End Select
    End With
End Function

Public Sub Extract()
    Dim wb As Workbook
    Set wb = ThisWorkbook
    Dim code_module As codeItem
    Dim savedPath As String, basePath As String
    Dim i As Long
   'check if vbproject accessible
    If Not ProjectAccessible(wb) Then
        MsgBox "The VBA project cannot be accessed programmatically"
        Exit Sub
    End If
   'check if temp folder acessible
    i = 0
    basePath = Environ$("Temp") & "\"
    Do While True
        i = i + 1
        code_module = getCodeDefinition(i)
        If code_module.extension = "missing" Then
            Exit Do
        Else
            savedPath = createFile(code_module, basePath)
            importFile savedPath, wb
            Kill savedPath
        End If
    Loop
    RemoveModule "myProject", wb
End Sub

Private Function ProjectAccessible(ByVal wb As Workbook) As Boolean
    On Error Resume Next
    With wb.VBProject
        ProjectAccessible = .Protection = vbext_pp_none
        ProjectAccessible = ProjectAccessible And Err.Number = 0
    End With
End Function

Private Function createFile(ByRef definition As codeItem, ByVal filePath As String) As String
    Dim newFileObj As Object
    Set newFileObj = CreateObject("ADODB.Stream")
    newFileObj.Type = TypeBinary
   'Open the stream and write binary data
    newFileObj.Open
   'create file from x64 string
    With definition
        Dim bytes() As Byte
        Dim fullPath As String
        fullPath = filePath & .module_name & .extension
        bytes = FromBase64(Join(.code_content))
        newFileObj.Write bytes
        newFileObj.SaveToFile fullPath, ForWriting
        createFile = fullPath
    End With
End Function

Private Sub importFile(ByVal filePath As String, ByRef wb As Workbook)
    wb.VBProject.VBComponents.Import filePath
End Sub

Private Function RemoveModule(ByVal moduleName As String, ByRef book As Workbook) As Boolean
    On Error Resume Next
    With book.VBProject.VBComponents
        .Remove .item(moduleName)
    End With
    RemoveModule = Not (Err.Number = 9)
End Function

Private Function FromBase64(ByVal Text As String) As Byte()
    Dim Out() As Byte
    Dim b64(0 To 255) As Byte, str() As Byte, i As Long, j As Long, v As Long, b0 As Long, b1 As Long, b2 As Long, b3 As Long
    Out = vbNullString
    If Len(Text) Then Else Exit Function

    str = " ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
    For i = 2 To UBound(str) Step 2
        b64(str(i)) = i \ 2
    Next

    ReDim Out(0 To ((Len(Text) + 3) \ 4) * 3 - 1)
    str = Text & String$(2, 0)

    For i = 0 To UBound(str) - 7 Step 2
        b0 = b64(str(i))

        If b0 Then
            b1 = b64(str(i + 2))
            b2 = b64(str(i + 4))
            b3 = b64(str(i + 6))
            v = b0 * 262144 + b1 * 4096& + b2 * 64& + b3 - 266305
            Out(j) = v \ 65536
            Out(j + 1) = (v \ 256&) Mod 256
            Out(j + 2) = v Mod 256
            j = j + 3
            i = i + 6
        End If
    Next

    If b2 = 0 Then
        Out(j - 3) = (v + 65) \ 65536
        j = j - 2
    ElseIf b3 = 0 Then
        Out(j - 3) = (v + 1) \ 65536
        Out(j - 2) = ((v + 1) \ 256&) Mod 256
        j = j - 1
    End If

    ReDim Preserve Out(j - 1)
    FromBase64 = Out
End Function
